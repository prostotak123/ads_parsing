#!/bin/bash

echo "‚û°Ô∏è Entrypoint –∑–∞–ø—É—â–µ–Ω–æ –∑ –∫–æ–º–∞–Ω–¥–æ—é: $@"

# –Ø–∫—â–æ —Ü–µ Celery worker ‚Äî –ù–ï –≤–∏–∫–æ–Ω—É—î–º–æ –º—ñ–≥—Ä–∞—Ü—ñ—ó
if [[ "$@" == *"celery"* ]]; then
  echo "üöÄ –ó–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è Celery ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ –º—ñ–≥—Ä–∞—Ü—ñ—ó."
  exec "$@"
fi

# –Ø–∫—â–æ —Ü–µ runserver/debugpy/gunicorn ‚Äî –≤–∏–∫–æ–Ω—É—î–º–æ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫—É
echo "üõ†Ô∏è  –í–∏–∫–æ–Ω—É—î–º–æ –º—ñ–≥—Ä–∞—Ü—ñ—ó..."
# –ì–µ–Ω–µ—Ä—É—î–º–æ –º—ñ–≥—Ä–∞—Ü—ñ—ó (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
python manage.py makemigrations --noinput
python manage.py migrate --noinput


echo "‚úÖ –ó–∞–ø—É—Å–∫–∞—î–º–æ –∫–æ–º–∞–Ω–¥—É: $@"
exec "$@"